import{_ as i,c as a,o as n,ag as h}from"./chunks/framework.D53w8jfx.js";const E=JSON.parse('{"title":"ç¬¬ 47 æ¡ï¼šä¼˜å…ˆä½¿ç”¨ç±»å‹å®‰å…¨çš„æ–¹æ³•è¿›è¡Œ Monkey Patching","description":"","frontmatter":{},"headers":[],"relativePath":"ch-any/type-safe-monkey.md","filePath":"ch-any/type-safe-monkey.md"}'),p={name:"ch-any/type-safe-monkey.md"};function t(l,s,k,e,d,r){return n(),a("div",null,s[0]||(s[0]=[h(`<h1 id="ç¬¬-47-æ¡-ä¼˜å…ˆä½¿ç”¨ç±»å‹å®‰å…¨çš„æ–¹æ³•è¿›è¡Œ-monkey-patching" tabindex="-1">ç¬¬ 47 æ¡ï¼šä¼˜å…ˆä½¿ç”¨ç±»å‹å®‰å…¨çš„æ–¹æ³•è¿›è¡Œ Monkey Patching <a class="header-anchor" href="#ç¬¬-47-æ¡-ä¼˜å…ˆä½¿ç”¨ç±»å‹å®‰å…¨çš„æ–¹æ³•è¿›è¡Œ-monkey-patching" aria-label="Permalink to &quot;ç¬¬ 47 æ¡ï¼šä¼˜å…ˆä½¿ç”¨ç±»å‹å®‰å…¨çš„æ–¹æ³•è¿›è¡Œ Monkey Patching&quot;">â€‹</a></h1><p>JavaScript æœ€è‘—åçš„ç‰¹æ€§ä¹‹ä¸€æ˜¯å…¶å¯¹è±¡å’Œç±»æ˜¯&quot;å¼€æ”¾çš„&quot;ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥å‘å®ƒä»¬æ·»åŠ ä»»æ„å±æ€§ã€‚è¿™æœ‰æ—¶è¢«ç”¨æ¥é€šè¿‡åœ¨ <code>window</code> æˆ– <code>document</code> ä¸Šèµ‹å€¼æ¥åˆ›å»ºå…¨å±€å˜é‡ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.monkey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Tamarin&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.monkey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Howler&#39;</span></span></code></pre></div><p>æˆ–è€…å°†æ•°æ®é™„åŠ åˆ° DOM å…ƒç´ ä¸Šï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> el</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;colobus&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">el.home </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tree&#39;</span></span></code></pre></div><p>åœ¨è¿è¡Œæ—¶å‘å†…ç½®å¯¹è±¡æ·»åŠ å±æ€§è¢«ç§°ä¸º&quot;monkey patching&quot;ï¼Œåœ¨ä½¿ç”¨ jQuery æˆ– D3 çš„ä»£ç ä¸­ç‰¹åˆ«å¸¸è§ã€‚</p><p>ä½ ç”šè‡³å¯ä»¥å‘å†…ç½®å¯¹è±¡çš„åŸå‹é™„åŠ å±æ€§ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿä»¤äººæƒŠè®¶çš„ç»“æœï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RegExp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prototype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.monkey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Capuchin&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;Capuchin&#39;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">123</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.monkey</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &#39;Capuchin&#39;</span></span></code></pre></div><p>è¿™äº›æ–¹æ³•é€šå¸¸ä¸æ˜¯å¥½çš„è®¾è®¡ã€‚å½“ä½ å°†æ•°æ®é™„åŠ åˆ° <code>window</code> æˆ– DOM èŠ‚ç‚¹æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨å°†å…¶å˜æˆå…¨å±€å˜é‡ã€‚è¿™ä½¿å¾—åœ¨ç¨‹åºçš„è¿œè·ç¦»éƒ¨åˆ†ä¹‹é—´å¾ˆå®¹æ˜“æ— æ„ä¸­å¼•å…¥ä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”æ„å‘³ç€æ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶éƒ½å¿…é¡»è€ƒè™‘å‰¯ä½œç”¨ã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¹‹å¤–ï¼ŒJavaScript ä½¿å¼•å…¥å…¨å±€å˜é‡å˜å¾—éå¸¸å®¹æ˜“ï¼šåªéœ€åœ¨èµ‹å€¼æ—¶å»æ‰ <code>let</code>ã€<code>var</code> æˆ– <code>const</code>ã€‚</p><p>æ·»åŠ  TypeScript ä¼šå¼•å…¥å¦ä¸€ä¸ªé—®é¢˜ï¼šè™½ç„¶ç±»å‹æ£€æŸ¥å™¨çŸ¥é“ <code>Document</code> å’Œ <code>HTMLElement</code> çš„å†…ç½®å±æ€§ï¼Œä½†å®ƒè‚¯å®šä¸çŸ¥é“ä½ æ·»åŠ çš„å±æ€§ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.monkey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Tamarin&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//       ~~~~~~ Property &#39;monkey&#39; does not exist on type &#39;Document&#39;</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/CYewxgrgtgpgdgFwHRRHA1jAngAgLw4DkAKgIZSkBOAlnIQNwBQA9MzuxzgH4+84AKlEAAcYlBLkKoM2QjlAwAzjjggEOGAA9qi9WhwTRRACLho8BIUZA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>ä¿®å¤æ­¤é”™è¯¯æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <code>any</code> æ–­è¨€ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;(document </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).monkey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Tamarin&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // OK</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/BQEw9gxgrgtgpgOwC4AICGBndCCeBKAOhjAQGs4cUBeFAcgBU0Y0AnASwVoG4UUB6PigDyAaQBQQA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>è¿™æ»¡è¶³äº†ç±»å‹æ£€æŸ¥å™¨ï¼Œä½†æ­£å¦‚ç°åœ¨åº”è¯¥ä¸ä»¤äººæƒŠè®¶çš„é‚£æ ·ï¼Œå®ƒæœ‰ä¸€äº›ç¼ºç‚¹ã€‚ä¸ä»»ä½•ä½¿ç”¨ <code>any</code> çš„æƒ…å†µä¸€æ ·ï¼Œä½ å¤±å»äº†ç±»å‹å®‰å…¨å’Œè¯­è¨€æœåŠ¡ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;(document </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).monky </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Tamarin&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Also OK, misspelled</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;(document </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).monkey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">Tamarin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Also OK, wrong type</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/BQEw9gxgrgtgpgOwC4AICGBndCCeBKAOhjAQGscUBeFAcgBU0Y0AnASwRoG4UUB6XlAEEANhjAoA8gGkANChisMGAA5xhwuCABQoSLESpM2fERKk4FarwZM2CXtz4CRYybJQB3ZiQDmKJDiqWkA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†æ•°æ®ç§»å‡º <code>window</code>ã€<code>document</code> æˆ– DOMã€‚ä½†å¦‚æœä½ ä¸èƒ½è¿™æ ·åšï¼ˆä¹Ÿè®¸ä½ æ­£åœ¨ä½¿ç”¨éœ€è¦å®ƒçš„åº“ï¼Œæˆ–è€…æ­£åœ¨è¿ç§» JavaScript åº”ç”¨ç¨‹åºï¼‰ï¼Œé‚£ä¹ˆ monkey patch å°±æ˜¯ä½ ç¯å¢ƒçš„ä¸€éƒ¨åˆ†ï¼ˆç¬¬ 76 æ¡ï¼‰ï¼Œä½ åº”è¯¥ç”¨ TypeScript æ¥å»ºæ¨¡å®ƒã€‚æ²¡æœ‰å®Œç¾çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½† <code>as any</code> ä¸ºå®‰å…¨æ€§å’Œå¼€å‘ä½“éªŒè®¾å®šäº†ä½æ ‡å‡†ï¼Œæœ‰æ–¹æ³•å¯ä»¥åšå¾—æ›´å¥½ã€‚</p><p>æƒ³è±¡ä½ æ­£åœ¨æ„å»ºä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œä½ æœ‰ä¸€ä¸ªåŒ…å«å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯çš„å¯¹è±¡ã€‚ä½ é€šè¿‡ API åœ¨é¡µé¢åŠ è½½æ—¶è·å–è¿™ä¸ªä¿¡æ¯ï¼Œå¹¶å°†å…¶å­˜å‚¨ä¸ºå…¨å±€å˜é‡ï¼Œä»¥ä¾¿åœ¨ä»£ç ä¸­æ–¹ä¾¿åœ°è®¿é—®ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;DOMContentLoaded&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/users/current-user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //     ~~~~ Property &#39;user&#39; does not exist</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //          on type &#39;Window &amp; typeof globalThis&#39;.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ... elsewhere ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greetUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Hello \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}!\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //                    ~~~~ Property &#39;user&#39; does not exist on type Window...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/JYOwLgpgTgZghgYwgAgKoGdrIN4ChnIhwC2EAXMumFKAOYDcuAvrrgCYD2CArqeAHRw2bAKIA3COAAywKpOgAKAEQARAPIBZAMIdwksFI5CIbJQBpkcdAE8QCZAoCUyALwA+HPmQJdVZFAh0AAdfFBdLAHc4YDBkGAgwBAALBQByAHo4IOB07kwodHSeKADwAFo86FTHRgIfED9KqFcHOCiY-0CQhoh+ACt0XSdnKzR82uQI0E4I-iaWpon09IJVgD8NteQABSgOIOgwa2RUptTkTkDCDliIAA9ZMC9l1dfV3WQjg5OAdWmOCLIABkn2sBw4MGQtAANhwAEZwaEAFSSslS-GYNVYL34uOQEGhmAiSWgKFxGPuISgsRg3DsYGAH1oAQSGEUzjwBERhwUAAMABIE2HIAAk2CmIBmc3y-CIpCYAEJeViCC83uqNchNltdvtDsdTvlzpd0Ndbg8-B8vig-pKAeTmLggA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>ç±»å‹é”™è¯¯å‡ºç°æ˜¯å› ä¸º TypeScript ä¸çŸ¥é“æˆ‘ä»¬å¯¹å…¨å±€å¯¹è±¡çš„è¡¥ä¸ã€‚ä¸å…¶å†™ <code>(window as any)</code>ï¼Œä¸€ä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨æ‰©å±•ï¼Œè¿™æ˜¯ <code>interface</code> çš„ç‰¹æ®Šèƒ½åŠ›ä¹‹ä¸€ï¼ˆç¬¬ 13 æ¡ï¼‰ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> global {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Window</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /** The currently logged-in user */</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/JYOwLgpgTgZghgYwgAgKoGdrIN4ChnIhwC2EAXMumFKAOYDcuAvrhAB4AOA9lGDiwBMICADZwoKWiK4AjOCJz5koSLEQoA6qAFcA7ooIEA9ACoTyACoALFAgCuUCeBEBPZNNq0IAgLShkdphQyCZGSgSB0BQY0IwELCxAA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>è¿™å‘Šè¯‰ TypeScript <code>Window</code> æœ‰å¦ä¸€ä¸ªå®ƒä»å†…ç½® DOM ç±»å‹ä¸­ä¸çŸ¥é“çš„å±æ€§ã€‚æœ‰äº†æ‰©å±•ï¼Œæˆ‘ä»¬çš„ä»£ç é€šè¿‡äº†ç±»å‹æ£€æŸ¥å™¨ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;DOMContentLoaded&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/users/current-user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// OK</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ... elsewhere ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greetUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Hello \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}!\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// OK</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/JYOwLgpgTgZghgYwgAgKoGdrIN4ChnIhwC2EAXMumFKAOYDcuAvrhAB4AOA9lGDiwBMICADZwoKWiK4AjOCJz5koSLEQoA6qAFcA7ooIEA9ACoTyACoALFAgCuUCeBEBPZNNq0IAgLShkdphQyCZGSgSB0BQY0IwELIJc9qTgAHRwAgIAogBuEOAAMsBU+dAAFABEACIA8gCyAMJc4PlgBVwZ3hUANMhw6C4gCMhlAJTIALwAfAbICM1UyBLo3CCYk326cMB8MBBgCFZlAORGcBzARpFQ6Eb2jq0+18ejcXMLfNcbZXBbO0sQFYLCCpABW6GaY3G-TQQTeum0elSXwmAThxiMyBqAGlmK9cLgjJjUiTkBARJhdDYJMgSalWJweLs7EMwMBmshaBJ9jEoGNZvJoGAygADAAS5OkyAAJNgESAdLpkUFUkRSEwAIQi14YrG4lhAA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>è¿™æ¯”ä½¿ç”¨ <code>any</code> åœ¨å‡ ä¸ªæ–¹é¢æœ‰æ‰€æ”¹è¿›ï¼š</p><ul><li>ä½ è·å¾—ç±»å‹å®‰å…¨ã€‚ç±»å‹æ£€æŸ¥å™¨ä¼šæ ‡è®°æ‹¼å†™é”™è¯¯æˆ–é”™è¯¯ç±»å‹çš„èµ‹å€¼ã€‚</li><li>ä½ å¯ä»¥ä¸ºå±æ€§é™„åŠ æ–‡æ¡£ï¼ˆç¬¬ 68 æ¡ï¼‰ã€‚</li><li>ä½ åœ¨å±æ€§ä¸Šè·å¾—è‡ªåŠ¨å®Œæˆå’Œå…¶ä»–è¯­è¨€æœåŠ¡ã€‚</li><li>æœ‰å…³äº monkey patch ç¡®åˆ‡å†…å®¹çš„è®°å½•ã€‚</li></ul><p>æ‰©å±•æ–¹æ³•æœ‰ä¸€äº›é—®é¢˜ã€‚åœ¨å…¨å±€å˜é‡åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶è®¾ç½®çš„æƒ…å†µä¸‹ï¼ˆå¦‚ <code>user</code>ï¼‰ï¼Œæ²¡æœ‰åŠæ³•åªåœ¨è¿™å‘ç”Ÿä¹‹åå¼•å…¥æ‰©å±•ã€‚è¿™æ©ç›–äº†æˆ‘ä»¬ä»£ç ä¸­çš„ç«æ€æ¡ä»¶ã€‚å¦‚æœæˆ‘ä»¬åœ¨ <code>window.user</code> è®¾ç½®ä¹‹å‰è°ƒç”¨ <code>greetUser()</code> ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p>ä¸ºäº†é¿å…è¿™æ ·çš„é—®é¢˜ï¼Œä½ å¯èƒ½æƒ³è¦åœ¨å…¨å±€å˜é‡ä¸­åŒ…å« <code>undefined</code> ä½œä¸ºå¯èƒ½æ€§ã€‚è¿™å°†å¼ºåˆ¶ä½ åœ¨è®¿é—® <code>user</code> çš„ä»»ä½•åœ°æ–¹å¤„ç† <code>user</code> ä¸å¯ç”¨çš„å¯èƒ½æ€§ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> global {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Window</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /** The currently logged-in user */</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greetUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Hello \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}!\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //             ~~~~~~~~~~~ &#39;window.user&#39; is possibly &#39;undefined&#39;.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/JYOwLgpgTgZghgYwgAgKoGdrIN4ChnIhwC2EAXMumFKAOYDcuAvrgCYQIA2cUKtnAewBGcTjnzJQkWIhQB1UKwEB3cQQIB6AFRbkAFQAWKBAFcovcJwCeyQbVoRWAWlDITmKMi0aJBd9AoMLAAfNxB2GFBHRgIWFlwNDWQAOlTcCAAPAAcBKDBkGBMQBDBgARBkWl4IMCCoAAoASjVkUWgweoADAAkITkFkABJsZUUVZP8oZKJSJgBCTsaY5ET1NfXkAD9tnd3N5AByUfDxyYPJdGQc9HRgIWtDooio1gPk5lwgA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>è¿™é‡Œåœ¨æ­£ç¡®æ€§å’Œä¾¿åˆ©æ€§ä¹‹é—´å­˜åœ¨æƒè¡¡ã€‚</p><p>å¦‚æœä½ çš„æœåŠ¡åŸºç¡€è®¾æ–½å…è®¸ï¼Œè¿™ç§ç‰¹å®šæƒ…å†µçš„å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å°† <code>user</code> å˜é‡å†…è”åˆ°é¡µé¢çš„ HTML ä¸­ï¼š</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text/javascript&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Bill Withers&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;your-code.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>è¿™æ ·ä½ å¯ä»¥å®‰å…¨åœ°ç§»é™¤ <code>undefined</code> çš„å¯èƒ½æ€§ï¼Œå› ä¸º <code>user</code> åœ¨ä½ çš„ä»»ä½•ä»£ç è¿è¡Œä¹‹å‰å·²ç»è¢«æ— æ¡ä»¶è®¾ç½®ï¼Œå¹¶ä¸”æ²¡æœ‰ç«æ€æ¡ä»¶çš„å¯èƒ½æ€§ã€‚</p><p>æ‰©å±•çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæ­£å¦‚ <code>declare global</code> æ‰€æš—ç¤ºçš„ï¼Œå®ƒå…¨å±€åº”ç”¨ã€‚ä½ æ— æ³•å°†å…¶ä»ä»£ç çš„å…¶ä»–éƒ¨åˆ†æˆ–åº“ä¸­éšè—ã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºåŒ…å«å¤šä¸ªé¡µé¢ï¼Œè€Œ <code>user</code> åªåœ¨å…¶ä¸­ä¸€äº›é¡µé¢ä¸Šå¯ç”¨ï¼Œå…¨å±€æ‰©å±•å°†æ— æ³•å‡†ç¡®å»ºæ¨¡ã€‚</p><p>ä¸æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸçš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ›´çª„çš„ç±»å‹æ–­è¨€ã€‚è€Œä¸æ˜¯ <code>(window as any)</code>ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¦ä¸€ä¸ªå¸¦æœ‰æˆ‘ä»¬æ·»åŠ å±æ€§çš„ç±»å‹ï¼š</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyWindow</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> window </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  /** The currently logged-in user */</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> undefined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">document</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addEventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;DOMContentLoaded&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  const</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/api/users/current-user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  const</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> user</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">json</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ;(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">window</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> as</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> MyWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).user = user </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// OK</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> greetUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`Hello \${</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyWindow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">).</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}!\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //             ~~~~~~~~~~~~~~~~~~~~~~~~~ Object is possibly &#39;undefined&#39;.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><a href="https://www.typescriptlang.org/play/?ts=5.4.5#code/JYOwLgpgTgZghgYwgAgKoGdrIN4ChnIhwC2EAXMumFKAOYDcuAvrmAJ4AOKAsmwOqgAJgHsA7sgC8yABTsuwmMlFCxASmQAyHPmQB6AFT7kAFQAWKBAFcoUCOAA2bZPeG1aEQQFpQyS5ijI+ro6ftAUGFgAPr4gghAwoB6MLLgiVqTgAHRwgoIAogBudmAAMsBUdtDSAEQAIgDy3ADCwuDFJcI5HtUANMhw6GwgCDLqEgB82gQIrVTItugcsyhScKJwwGDIMBBgCKbSAOS6cBzAuqFQ6LpWNsWel4eqjNOzW5eSMmsbWwtLIJhMgArdCtaSqdQDND+F4yZSxMT9dDIXgCBGiVSZD5SS70Ai6XTIeoAaWYz1wuAJyEyNNwEAAHksoFsYJZhmBgK1kLRbLsIlBwVN+vZoGBpAADAASEHsLmQABJsNJ4SJxFDUSoMVj-JkiKQmABCcXk-GEgjmi3mgB+NttdvtDrtRIARkCIAgtuVkEt0OhgM7HMhDmy4gkQB5DplmLggA" target="_blank" rel="noreferrer">ğŸ’» playground</a></p><p>TypeScript å¯¹ç±»å‹æ–­è¨€æ²¡é—®é¢˜ï¼Œå› ä¸º <code>Window</code> å’Œ <code>MyWindow</code> å…±äº«å±æ€§ï¼ˆç¬¬ 9 æ¡ï¼‰ã€‚ä½ åœ¨èµ‹å€¼ä¸­è·å¾—ç±»å‹å®‰å…¨ã€‚ä½œç”¨åŸŸé—®é¢˜ä¹Ÿæ›´æ˜“äºç®¡ç†ï¼šæ²¡æœ‰å¯¹ <code>Window</code> ç±»å‹çš„å…¨å±€ä¿®æ”¹ï¼Œåªæ˜¯å¼•å…¥äº†ä¸€ä¸ªæ–°ç±»å‹ï¼ˆåªæœ‰åœ¨ä½ å¯¼å…¥å®ƒæ—¶æ‰æœ‰ä½œç”¨åŸŸï¼‰ã€‚</p><p>ç¼ºç‚¹æ˜¯æ¯æ¬¡å¼•ç”¨ monkey-patched å±æ€§æ—¶éƒ½å¿…é¡»å†™æ–­è¨€ï¼ˆæˆ–å¼•å…¥æ–°å˜é‡ï¼‰ã€‚ä½ ä¼šæƒ³è¦å¼ºåˆ¶æ‰§è¡Œæ²¡æœ‰äººå·å·ä½¿ç”¨ <code>(window as any)</code>ï¼Œä¹Ÿè®¸ä½¿ç”¨ linter è§„åˆ™ã€‚</p><p>ä½†ä½ å¯ä»¥æŠŠè¿™ä¸€åˆ‡å½“ä½œé¼“åŠ±é‡æ„ä¸ºæ›´ç»“æ„åŒ–çš„ä¸œè¥¿ã€‚Monkey patching ä¸åº”è¯¥å¤ªå®¹æ˜“ï¼</p><h2 id="è¦ç‚¹å›é¡¾" tabindex="-1">è¦ç‚¹å›é¡¾ <a class="header-anchor" href="#è¦ç‚¹å›é¡¾" aria-label="Permalink to &quot;è¦ç‚¹å›é¡¾&quot;">â€‹</a></h2><ul><li>ä¼˜å…ˆä½¿ç”¨ç»“æ„åŒ–ä»£ç ï¼Œè€Œä¸æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨å…¨å±€å˜é‡æˆ– DOM ä¸Šã€‚</li><li>å¦‚æœå¿…é¡»å°†æ•°æ®å­˜å‚¨åœ¨å†…å»ºç±»å‹ä¸Šï¼Œä½¿ç”¨ç±»å‹å®‰å…¨çš„æ–¹æ³•ï¼ˆå¦‚æ‰©å±•æˆ–æ–­è¨€è‡ªå®šä¹‰æ¥å£ï¼‰ã€‚</li><li>ç†è§£æ‰©å±•çš„ä½œç”¨åŸŸé—®é¢˜ã€‚å¦‚æœåœ¨è¿è¡Œæ—¶å¯èƒ½å‡ºç° <code>undefined</code>ï¼Œåˆ™éœ€è¦åœ¨ç±»å‹ä¸­åŒ…å« <code>undefined</code>ã€‚</li></ul>`,47)]))}const y=i(p,[["render",t]]);export{E as __pageData,y as default};
